## Specification for Validating ZNT1001 Analyzer

This document provides a clear-cut specification for validating the `ZNT1001ImmutabilityAnalyzer`. The goal is to ensure the analyzer correctly identifies and reports diagnostics for non-compliant code while remaining silent for compliant code, in accordance with the Zentient framework's immutability doctrine.

-----

### 1\. Test Environment

  * **Platform:** .NET 8 or later.
  * **Dependencies:** The test project must reference `Zentient.Abstractions` (or a mock equivalent) containing the following interfaces: `IResult`, `IMetadata`, `IErrorInfo`, `ICode`, and `IValidationContext`.
  * **Analyzer Project:** The test environment must be configured to run the `ZNT1001ImmutabilityAnalyzer` against the test code.

-----

### 2\. Validation Test Cases

The following test cases are required to validate the analyzer's behavior. Each case includes a positive and negative example.

#### Case 1: ZNT1001A - Concrete Type Must Be Sealed

This test validates that concrete types implementing core abstractions are declared `sealed`.

  * **Positive Case (No Diagnostic):** A `sealed` class implementing a target interface.

    ```csharp
    public sealed class CompliantResult : Zentient.Abstractions.Results.IResult { ... }
    ```

    **Expected Behavior:** The analyzer should **not** report diagnostic `ZNT1001A`.

  * **Negative Case (Diagnostic Expected):** A public, non-sealed class implementing a target interface.

    ```csharp
    public class NonCompliantResult : Zentient.Abstractions.Results.IResult { ... }
    ```

    **Expected Behavior:** The analyzer should report diagnostic `ZNT1001A` on `NonCompliantResult`.

#### Case 2: ZNT1001B - Properties Must Be Get-Only

This test validates that all properties on a target type are get-only.

  * **Positive Case (No Diagnostic):** A class with only get-only properties.

    ```csharp
    public sealed class CompliantMetadata : Zentient.Abstractions.Metadata.IMetadata
    {
        public int Count { get; }
        public IEnumerable<string> Keys { get; }
        // Other members...
    }
    ```

    **Expected Behavior:** The analyzer should **not** report diagnostic `ZNT1001B`.

  * **Negative Case (Diagnostic Expected):** A class with a public or internal `set` accessor on any property.

    ```csharp
    public sealed class NonCompliantErrorInfo : Zentient.Abstractions.Errors.IErrorInfo<TErrorDef>
    {
        public string Message { get; set; } // Non-compliant
        public IReadOnlyCollection<string> OtherData { get; internal set; } // Non-compliant
        // Other members...
    }
    ```

    **Expected Behavior:** The analyzer should report diagnostic `ZNT1001B` on both the `Message` and `OtherData` properties.

#### Case 3: ZNT1001C - No Public Constructors

This test validates that a target type has no public or internal constructors.

  * **Positive Case (No Diagnostic):** A class with a private or protected constructor and no public/internal constructors.

    ```csharp
    public sealed class CompliantCode : Zentient.Abstractions.Codes.ICode<ICodeDef>
    {
        private CompliantCode() { }
        // Static factory method for creation...
    }
    ```

    **Expected Behavior:** The analyzer should **not** report diagnostic `ZNT1001C`.

  * **Negative Case (Diagnostic Expected):** A class with a public or internal constructor.

    ```csharp
    public sealed class NonCompliantMetadata : Zentient.Abstractions.Metadata.IMetadata
    {
        public NonCompliantMetadata() { } // Non-compliant
        public NonCompliantMetadata(int initialValue) { } // Non-compliant
        internal NonCompliantMetadata(string name) { } // Non-compliant
        // Other members...
    }
    ```

    **Expected Behavior:** The analyzer should report diagnostic `ZNT1001C` on `NonCompliantMetadata`.

#### Case 4: ZNT1001D - Must Have Static Factory Methods

This test is specific to concrete types implementing `IValidationContext`, which lacks a builder in the abstractions. It validates that the class provides at least one static factory method.

  * **Positive Case (No Diagnostic):** A `sealed` class implementing `IValidationContext` with a static factory method.

    ```csharp
    public sealed class CompliantValidationContext : Zentient.Abstractions.Validation.IValidationContext
    {
        private CompliantValidationContext() { }
        public static CompliantValidationContext Create() { return new(); } // Compliant
        // Other members...
    }
    ```

    **Expected Behavior:** The analyzer should **not** report diagnostic `ZNT1001D`.

  * **Negative Case (Diagnostic Expected):** A `sealed` class implementing `IValidationContext` with no static factory methods.

    ```csharp
    public sealed class NonCompliantValidationContext : Zentient.Abstractions.Validation.IValidationContext
    {
        private NonCompliantValidationContext() { }
        // No public/internal static factory method. Non-compliant.
    }
    ```

    **Expected Behavior:** The analyzer should report diagnostic `ZNT1001D` on `NonCompliantValidationContext`.

By successfully passing all of these test cases, the `ZNT1001ImmutabilityAnalyzer` can be considered properly validated and ready for use.
